# This drop-in file is generated by KubeXM.
[Service]
  # KUBELET_KUBECONFIG_ARGS 包含了认证相关的 kubeconfig 路径。
  # - 对于 master 节点，它只包含 --kubeconfig。
  # - 对于 worker 节点，它同时包含 --bootstrap-kubeconfig 和 --kubeconfig。
  Environment="KUBELET_KUBECONFIG_ARGS={{ .KubeconfigArgs }}"
  
  # KUBELET_CONFIG_ARGS 指向我们的核心配置文件。
  Environment="KUBELET_CONFIG_ARGS=--config={{ .ConfigYAMLPath }}"
  
  # KUBELET_OTHER_ARGS 包含了所有其他动态生成的参数。
  Environment="KUBELET_OTHER_ARGS=--cgroup-driver={{ .CgroupDriver }} --container-runtime=remote --container-runtime-endpoint={{ .ContainerRuntimeEndpoint }} --pod-infra-container-image={{ .PodInfraContainerImage }} --node-ip={{ .NodeIP }}"
  
  # KUBELET_EXTRA_ARGS 仍然可以由 /etc/default/kubelet 提供，作为管理员手动覆盖的后门。
  EnvironmentFile=-/etc/default/kubelet
  
  # 清空原始的 ExecStart，然后定义一个新的，将所有来源的参数组合在一起。
  ExecStart=
  ExecStart=/usr/local/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_OTHER_ARGS $KUBELET_EXTRA_ARGS